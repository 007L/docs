<div class="static-content">

  <div class="index-list">
    <ul>
      <li><a href="#page-basic">Basic configuration</a></li>
      <li><a href="#page-selecting">Selecting ranges</a></li>
      <li><a href="#page-getting">Getting data from the selected ranges</a></li>
      <li><a href="#page-modifying">Modifying the selected cells</a></li>
      <li><a href="#page-styling">Styling the selection area</a></li>
    </ul>
  </div>

  <div class="example-container clearfix" name="default">
    <h3 id="page-basic">Basic configuration</h3>
    <p>With this plugin you can select single cells or ranges of cells across a spreadsheet.
      Selected cells can be then cleaned from data or modified.
    </p>
    <p>
      This plugin is enabled by default. To disable an ability to select cells set
      <code>disableVisualSelection</code> to <code>true</code>.
    </p>
    <p>
      Use <kbd>CMD</kbd> on Mac or <kbd>CTRL</kbd> on Windows to select non-adjacent ranges of cells.
    </p>
  </div>

  <div class="example-container clearfix head-gap" name="selecting">
    <h3  id="page-selecting">Selecting ranges</h3>
    <p>There are different modes in which you can use this plugin. Choose between selecting a single cell,
      a range of adjacent cells and multiple ranges of non-contiguous cells.
    </p>
    <p>Possible values of <code>selectionMode</code>:</p>
    <ul>
      <li><code>single</code> - A single cell can be selected,</li>
      <li><code>range</code> - Multiple cells within a single range can be selected,</li>
      <li><code>multiple</code> - Multiple non-contiguous ranges of cells can be selected.</li>
    </ul>

    <div data-jsfiddle="example2">

      <div>
        <select id="selectOption" style="width: auto; margin-top: 16px;">
          <option>Single selection</option>
          <option>Range selection</option>
          <option selected="selected">Multiple selection</option>
        </select>
      </div>

      <div id="example2" class="hot head-gap"></div>
    </div>

    <div class="codeLayout">
      <div class="buttons">
        <button class="jsFiddleLink" data-runfiddle="example2">
          <i class="fa fa-jsfiddle"></i>
          Edit
        </button>
        <button class="dump" name="dump" data-dump="#example2" data-instance="hot2"
                title="Print current data source to console">
          <i class="fa fa-terminal"></i>
          Dump data to console
        </button>
      </div>
      <script data-jsfiddle="example2">
        var
          example2 = document.getElementById('example2'),
          selectOption = document.getElementById('selectOption'),
          settings2,
          hot2;

        settings2 = {
          data: Handsontable.helper.createSpreadsheetData(100, 100),
          width: 650,
          height: 418,
          colWidths: 100,
          rowHeights: 23,
          rowHeaders: true,
          colHeaders: true,
          selectionMode: 'multiple', // single, range or multiple
        };
        hot2 = new Handsontable(example2, settings2);

        Handsontable.dom.addEvent(selectOption, 'change', (event) => {
          var value = event.target.value;
          var first = value.split(' ')[0].toLowerCase();

          hot2.updateSettings({
            selectionMode: first
          });
        });
      </script>
    </div>
  </div>

  <div class="example-container clearfix head-gap" name="getting">
    <h3  id="page-getting">Getting data from the selected ranges</h3>
    <p>To retrieve the selected cells a an array of arrays, you should use ...</p>

    <div data-jsfiddle="example3">
      <div id="example3" class="hot head-gap"></div>
      <textarea style="margin: 16px 0 7px; width: 350px; height: 87px;" id="output"></textarea>
      <div>
        <button class="intext-btn" id="getButton">Get data</button>
      </div>
    </div>

    <div class="codeLayout">
      <div class="buttons">
        <button class="jsFiddleLink" data-runfiddle="example3">
          <i class="fa fa-jsfiddle"></i>
          Edit
        </button>
        <button class="dump" name="dump" data-dump="#example3" data-instance="hot3"
                title="Print current data source to console">
          <i class="fa fa-terminal"></i>
          Dump data to console
        </button>
      </div>
      <script data-jsfiddle="example3">
        var
          example3 = document.getElementById('example3'),
          output = document.getElementById('output'),
          getButton = document.getElementById('getButton'),
          settings3,
          hot3;

        settings3 = {
          data: Handsontable.helper.createSpreadsheetData(100, 100),
          width: 650,
          height: 418,
          colWidths: 100,
          rowHeights: 23,
          rowHeaders: true,
          colHeaders: true,
          outsideClickDeselects: false,
          selectionMode: 'multiple', // single, range or multiple
        };
        hot3 = new Handsontable(example3, settings3);

        Handsontable.dom.addEvent(getButton, 'click', () => {
          const selected = hot3.getSelected();
          const data = [];

          for (let index = 0; index < selected.length; index += 1) {
            let item = selected[index];

            data.push(hot3.getData(...item));
          }

          output.value = data;
        });
      </script>
    </div>
  </div>

  <div class="example-container clearfix head-gap" name="modifying">
    <h3  id="page-modifying">Modifying the selected cells</h3>
    <p>You may need to delete, format or otherwise change the selected cells.
      This can be done by using ...
    </p>

    <div data-jsfiddle="example4">
      <div id="example4" class="hot head-gap"></div>
      <div id="buttons" style="margin-top: 10px;">
        <button class="intext-btn" id="setButton">Set data</button>
        <button class="intext-btn" id="addButton">Add class</button>
      </div>
    </div>

    <div class="codeLayout">
      <div class="buttons">
        <button class="jsFiddleLink" data-runfiddle="example4">
          <i class="fa fa-jsfiddle"></i>
          Edit
        </button>
        <button class="dump" name="dump" data-dump="#example4" data-instance="hot4"
                title="Print current data source to console">
          <i class="fa fa-terminal"></i>
          Dump data to console
        </button>
      </div>
      <script data-jsfiddle="example4">
        var
          example4 = document.getElementById('example4'),
          buttons = document.getElementById('buttons'),
          settings4,
          hot4;

        settings4 = {
          data: Handsontable.helper.createSpreadsheetData(100, 100),
          width: 650,
          height: 418,
          colWidths: 100,
          rowHeights: 23,
          rowHeaders: true,
          colHeaders: true,
          outsideClickDeselects: false,
          selectionMode: 'multiple', // single, range or multiple
        };
        hot4 = new Handsontable(example4, settings4);

        buttons.addEventListener('click', (event) => {
          const selected = hot4.getSelected();
          const target = event.target.id;

          for (let index = 0; index < selected.length; index += 1) {
            let item = selected[index];
            let [startRow, startCol, stopRow, stopCol] = item;

            if (startRow !== stopRow || startCol !== stopCol) {
              for (let rowIndex = startRow; rowIndex <= stopRow; rowIndex += 1) {
                for (let columnIndex = startCol; columnIndex <= stopCol; columnIndex += 1) {

                  if (target === 'setButton') {
                    hot4.setDataAtCell(rowIndex, columnIndex, 'data changed');
                  }

                  if (target === 'addButton') {
                    hot4.setCellMeta(rowIndex, columnIndex, 'className', 'c-deeporange');
                    hot4.render();
                  }
                }
              }

            } else {
              if (target === 'setButton') {
                hot4.setDataAtCell(startRow, startCol, 'data changed');
              }

              if (target === 'addButton') {
                hot4.setCellMeta(startRow, startCol, 'className', 'c-deeporange');
                hot4.render();
              }
            }
          }
        });
      </script>
    </div>
  </div>

  <div class="example-container clearfix head-gap" name="styling">
    <h3  id="page-styling">Styling the selection area</h3>
    <p>The background color can be easily changed with CSS styles.
      The main, light blue background color, is defined in class <code>.area</code>.
    </p>
    <p>For non-consecutive selection there are multiple classes making each level a bit darker.
      These classes are called <code>area-1</code>, <code>area-2</code> etc.
    </p>
    <p>
      Unfortunately, there is no easy way to change the border color of selection.
    </p>
  </div>
  <p class="gap-top-xsmall">
    <a href="https://github.com/handsontable/docs/edit/<?js= version ?>/tutorials/selecting-ranges.html" class="edit-doc" target="_blank">
      Help us improve this page
    </a>
  </p>
</div>
